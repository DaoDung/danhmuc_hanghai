
<%@ page contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%>

<object id="plugin0" type="application/x-cryptolib05plugin" width="0" height="0"></object>

<script type="text/javascript">
		
		function plugin0() {
            return document.getElementById('plugin0');
        }
        var plugin = plugin0;

</script>

<script type="text/javascript">
    document
        .addEventListener(
            'DOMContentLoaded',
            function (event) {
                
            	var data_header = '[{"text": "STT","align": "left","sortable": false},{"text": "Tình trạng","align": "center","sortable": false,"value": "requestState"},{"text": "Mã bản khai","align": "center","sortable": false,"value": "title"},{"text": "Tên tàu","align": "center","sortable": false,"value": "tentau"},{"text": "Hô hiệu","align": "center","sortable": false,"value": "tentau"},{"text": "IMO","align": "center","sortable": false,"value": "tentau"},{"text": "Quốc tịch","align": "center","sortable": false,"value": "stateCode"},{"text": "Ngày dự kiến tàu đến","align": "center","sortable": false,"value": "tentau"},{"text": "Đại lý đến","align": "center","sortable": false,"value": "tentau"},{"text": "Thời gian nộp hồ sơ","align": "center","sortable": false,"value": "tentau"}]';
            	var data_state = '{"AD": "ANDORRA","AE": "UNITED ARAB EMIRATES","AF": "AFGANISTAN","AG": "ANTIGUA AND BARBUDA","AI": "ANGUILLA","AL": "ALBANIA","AM": "ARMENIA","AO": "ANGOLA","AR": "ARGENTINA","AS": "AMERICAN SAMOA","AT": "AUSTRIA","AU": "AUSTRALIA","AW": "ARUBA","AZ": "AZERBAIJAN","BA": "BOSNIA AND HERZEGOWINA","BB": "BARBADOS","BD": "BANGLADESH","BE": "BELGIUM","BF": "BURKINA FASO","BG": "BULGARIA","BH": "BAHRAIN","BI": "BURUNDI","BJ": "BENIN","BM": "BERMUDA","BN": "BRUNEI DARUSSALAM","BO": "BOLIVIA","BQ": "B.A.T.","BR": "BRAZIL","BS": "BAHAMAS","BT": "BHUTAN","BW": "BOTSWANA","BY": "BELARUS","BZ": "BELIZE","CA": "CANADA","CC": "COCOS (KEELING) ISLANDS","CD": "CONGO (DEMOCRATIC REP.)","CF": "CENTRAL AFRICAN REPUBLIC","CG": "CONGO","CH": "SWITZERLAND","CI": "COTE DIVOIRE (IVORY COAST)","CK": "COOK ISLANDS","CL": "CHILE","CM": "CAMEROON","CN": "CHINA","CO": "COLOMBIA","CR": "COSTA RICA","CU": "CUBA","CV": "CAPE VERDE ISLANDS","CX": "CHRISTMAS ISLANDS","CY": "CYPRUS","CZ": "CZECH REPUBLIC","DE": "GERMANY","DJ": "DJIBOUTI","DK": "DENMARK","DM": "DOMINICA","DO": "DOMINICAN REPUBLIC","DZ": "ALGERIA","EC": "ECUADOR","EE": "ESTONIA","EG": "EGYPT","EH": "WESTERN SAHARA","ER": "ERITREA","ES": "SPAIN","ET": "ETHIOPIA","FI": "FINLAND","FJ": "FIJI","FK": "FALKLAND ISLANDS (MALVINAS)","FM": "MICRONESIA (FEDERATED STATE)","FO": "FAROE ISLANDS","FR": "FRANCE","GA": "GABON","GB": "UNITED KINGDOM","GD": "GRENADA","GE": "GEORGIA","GF": "FRENCH GUIANA","GH": "GHANA","GI": "GIBRALTAR","GL": "GREENLAND","GM": "GAMBIA","GN": "GUINEA","GP": "GUADELOUPE","GQ": "EQUATORIAL GUINEA","GR": "GREECE","GS": "SOUTH GEORGIA & THE SOUTH SANDWICH ISLAN","GT": "GUATEMALA","GU": "GUAM","GW": "GUINEA-BISSAU","GY": "GUYANA","HK": "HONGKONG","HN": "HONDURAS","HR": "CROATIA (HRVATSKA)","HT": "HAITI","HU": "HUNGARY","ID": "INDONESIA","IE": "IRELAND","IL": "ISRAEL","IN": "INDIA","IO": "BRITISH INDIAN OCEAN TERRITORY","IQ": "IRAQ","IR": "IRAN (ISLAMIC REP.)","IS": "ICELAND","IT": "ITALY","JM": "JAMAICA","JO": "JORDAN","JP": "JAPAN","KE": "KENYA","KG": "KYRGYZSTAN","KH": "CAMBODIA","KI": "KIRIBATI","KM": "COMOROS","KN": "SAINT KITTS & NEVIS","KP": "KOREA (DEMOCRATIC PEOPLES REP.)","KR": "KOREA (REPUBLIC)","KW": "KUWAIT","KY": "CAYMAN ISLANDS","KZ": "KAZAKHSTAN","LA": "LAOS","LB": "LEBANON","LC": "SAINT LUCIA","LI": "LIECHTENSTEIN","LK": "SRI LANKA","LR": "LIBERIA","LS": "LESOTHO","LT": "LITHUANIA","LU": "LUXEMBOURG","LV": "LATVIA","LY": "LIBYAN ARAB JAMAHIRIYA","MA": "MOROCCO","MC": "MONACO","MD": "MOLDOVA (REP.)","ME": "MONTENEGRO","MG": "MADAGASCAR","MH": "MARSHALL ISLANDS","MK": "MACEDONIA","ML": "MALI","MM": "MYANMAR (BURMA)","MN": "MONGOLIA","MO": "MACAU","MP": "NORTHERN MARIANA ISLANDS","MQ": "MARTINIQUE","MR": "MAURITANIA","MS": "MONTSERRAT","MT": "MALTA","MU": "MAURITIUS","MV": "MALDIVES","MW": "MALAWI","MX": "MEXICO","MY": "MALAYSIA","MZ": "MOZAMBIQUE","NA": "NAMIBIA","NC": "NEW CALEDONIA","NE": "NIGER","NF": "NORFOLK ISLAND","NG": "NIGERIA","NI": "NICARAGUA","NL": "NETHERLANDS","NO": "NORWAY","NP": "NEPAL","NR": "NAURU","NU": "NIUE","NZ": "NEW ZEALAND","OM": "OMAN","PA": "PANAMA","PE": "PERU","PF": "FRENCH POLINESIA","PG": "PAPUA NEW GUINEA","PH": "PHILIPPINES","PK": "PAKISTAN","PL": "POLAND","PM": "SAINT PIERRE & MIQUELON","PN": "PITCAIRN","PR": "PUERTO RICO","PT": "PORTUGAL","PW": "PALAU","PY": "PARAGUAY","QA": "QATAR","RE": "REUNION","RO": "ROMANIA","RS": "SERBIA","RU": "RUSSIAN FEDERATION","RW": "RWANDA","SA": "SAUDI ARABIA","SB": "SOLOMON ISLANDS","SC": "SEYCHELLES","SD": "SUDAN","SE": "SWEDEN","SG": "SINGAPORE","SH": "SAINT HELENA","SI": "SLOVENIA","SJ": "SVALBARD & JAN MAYEN ISLANDS","SK": "SLOVAKIA (SLOVAK REP.)","SL": "SIERRA LEONE","SM": "SAN MARINO","SN": "SENEGAL","SO": "SOMALIA","SR": "SURINAME","SS": "SUDAN","ST": "SAO TOME & PRINCIPE","SV": "EL SALVADOR","SY": "SYRIAN ARAB (REP.)","SZ": "SWAZILAND","TC": "TURKS & CAICOS ISLANDS","TD": "CHAD","TG": "TOGO","TH": "THAILAND","TJ": "TAJIKISTAN","TK": "TOKELAU","TL": "EAST TIMOR","TM": "TURKMENISTAN","TN": "TUNISIA","TO": "TONGA","TR": "TURKEY","TT": "TRINIDAD & TOBAGO","TV": "TUVALU","TW": "TAIWAN","TZ": "TANZANIA (UNITED REP.)","UA": "UKRAINE","UG": "UGANDA","UM": "UNITED STATES MINOR OUTLYING ISLANDS","US": "UNITED STATES OF AMERICA","UY": "URUGUAY","UZ": "UZBEKISTAN","VA": "VATICAN CITY","VC": "SAINT VINCENT & GRENADINES","VE": "VENEZUELA","VG": "BRITISH VIRGIN ISLANDS","VI": "VIRGIN ISLANDS (U.S.)","VN": "VIET NAM","VU": "VANUATU","WF": "WALLIS & FUTUNA ISLANDS","WS": "SAMOA","YE": "YEMEN","YT": "FRANCE","ZA": "SOUTH AFRICA","ZM": "ZAMBIA","ZW": "ZIMBABWE","PS": "PALESTINE","YU": "YUGOSLAVIA","GZ": "GAZA STRIP","GG": "GUERNSEY","AN": "NETHERLANDS ANTILLES","CS": "SERBIA AND MONTENEGRO","AQ": "ANTARCTICA","BV": "BOUVET ISLAND","FA": "FAEROE ISLANDS","FX": "FRANCE, METROPOLITAN","TF": "FRENCH SOUTHERN TERRITORIES","HE": "HEARD","MI": "MICRONESIA","UN": "UNITED OF AMERICAN","UN": "UNITED STATES MINOR","WA": "WALLIS AND FUTUNA","HA": "HAI PHAN QUOC TE","DA": "DANISH","TP": "EAST TIMOR","HM": "HEARD AND MC DONALD ISLANDS","IM": "ISLE OF MAN","JE": "JERSEY","WE": "WEST BANK","UE": "UNITED ARAB EMIRATES","KT": "ST KITTS AND NEVIS","HP": "HELLENIC REPUBLIC"}';
            	var data_doc_type = '{"NC": "Tàu thuyền nhập cảnh","XC": "Tàu thuyền xuất cảnh","QC": "Tàu thuyền quá cảnh","4": "Tàu thuyền vào cảng","5": "Tàu thuyền rời cảng","8": "Nhập cảnh dầu khí","9": "Xuất cảnh dầu khí","10": "Vào cảng dầu khí","11": "Rời cảng dầu khí","12": "Chuyển cảng vào","13": "Chuyển cảng rời"}';
            	
                var config = {};
                // serveResource api
                var getDetailHoSo = '<portlet:resourceURL id="getDetailHoSo"></portlet:resourceURL>';
                var getRoleFilterStatus = '<portlet:resourceURL id="getRoleFilterStatus"></portlet:resourceURL>';
                var getHoSoKeHoachTable = '<portlet:resourceURL id="getHoSoKeHoachTable"></portlet:resourceURL>';
                var counterHoSoKeHoachTable = '<portlet:resourceURL id="counterHoSoKeHoachTable"></portlet:resourceURL>';
                var getHoSoThuTucTable = '<portlet:resourceURL id="getHoSoThuTucTable"></portlet:resourceURL>';
                var counterHoSoThuTucTable = '<portlet:resourceURL id="counterHoSoThuTucTable"></portlet:resourceURL>';
                var getHistoryTable = '<portlet:resourceURL id="getHistoryTable"></portlet:resourceURL>';
                var getPhanHoiTuCoQuanChuyenNganhTable = '<portlet:resourceURL id="getPhanHoiTuCoQuanChuyenNganhTable"></portlet:resourceURL>';
                var exportPDFDetail = '<portlet:resourceURL id="exportPDFDetail"></portlet:resourceURL>';
                var getThanhPhanHoSo = '<portlet:resourceURL id="getThanhPhanHoSo"></portlet:resourceURL>';
                var getFileThanhPhanVersionList = '<portlet:resourceURL id="getFileThanhPhanVersionList"></portlet:resourceURL>';
                var exportPDFDetailThanhPhan = '<portlet:resourceURL id="exportPDFDetailThanhPhan"></portlet:resourceURL>';
                var getThongTinKhaiBaoTable = '<portlet:resourceURL id="getThongTinKhaiBaoTable"></portlet:resourceURL>';
                var getDocTypes = '<portlet:resourceURL id="getDocTypes"></portlet:resourceURL>';
                var getFilterADVDataAPI = '<portlet:resourceURL id="getFilterADVDataAPI"></portlet:resourceURL>';
                var counterHoSoAll = '<portlet:resourceURL id="counterHoSoAll"></portlet:resourceURL>';
                var getGiayToXuatTrinhPhuongTien = '<portlet:resourceURL id="getGiayToXuatTrinhPhuongTien"></portlet:resourceURL>';
                var getGiayToXuatTrinh_39 = '<portlet:resourceURL id="getGiayToXuatTrinh_39"></portlet:resourceURL>';
                var getGiayToXuatTrinh_40 = '<portlet:resourceURL id="getGiayToXuatTrinh_40"></portlet:resourceURL>';
                var getGiayToXuatTrinh_48 = '<portlet:resourceURL id="getGiayToXuatTrinh_48"></portlet:resourceURL>';
                var getGiayToXuatTrinh_49 = '<portlet:resourceURL id="getGiayToXuatTrinh_49"></portlet:resourceURL>';
                var getGiayToXuatTrinh_50 = '<portlet:resourceURL id="getGiayToXuatTrinh_50"></portlet:resourceURL>';
                var getMessageType23EXT = '<portlet:resourceURL id="getMessageType23EXT"></portlet:resourceURL>';
                var getLenhDieuDongEXT = '<portlet:resourceURL id="getLenhDieuDongEXT"></portlet:resourceURL>';
                var getMessageType60EXT = '<portlet:resourceURL id="getMessageType60EXT"></portlet:resourceURL>';
                var getMessageType60EXTTable = '<portlet:resourceURL id="getMessageType60EXTTable"></portlet:resourceURL>';
                var getMessageType60EXTTableQC = '<portlet:resourceURL id="getMessageType60EXTTableQC"></portlet:resourceURL>';
                var getMessageType90EXT = '<portlet:resourceURL id="getMessageType90EXT"></portlet:resourceURL>';
                var getNotifications = '<portlet:resourceURL id="getNotifications"></portlet:resourceURL>';

                // check role show btn
                var checkThanhPhanActionButton = '<portlet:resourceURL id="checkThanhPhanActionButton"></portlet:resourceURL>';
                //action TT1
                var actionKeHoachURL = '<portlet:actionURL windowState="exclusive" name="actionKeHoachNhapCanh"></portlet:actionURL>';
                var actionThuTucURL = '<portlet:actionURL windowState="exclusive" name="actionThuTucNhapCanh"></portlet:actionURL>';
                var chuyenGiaoDienLenhDieuDongURL = '<portlet:actionURL windowState="exclusive" name="chuyenGiaoDienLenhDieuDong"></portlet:actionURL>';
                var kiemDuyetHoSoNhapCanhURL = '<portlet:actionURL windowState="exclusive" name="kiemDuyetHoSoNhapCanh"></portlet:actionURL>';
                //action TT2
                var actionKeHoachXuatCanhURL = '<portlet:actionURL windowState="exclusive" name="actionKeHoachXuatCanh"></portlet:actionURL>';
                var actionThuTucXuatCanhURL = '<portlet:actionURL windowState="exclusive" name="actionThuTucXuatCanh"></portlet:actionURL>';
                var kiemDuyetHoSoXuatCanhURL = '<portlet:actionURL windowState="exclusive" name="kiemDuyetHoSoXuatCanh"></portlet:actionURL>';
                // action all in one
                var actionKeHoachAllInOneURL = '<portlet:actionURL windowState="exclusive" name="actionKeHoach"></portlet:actionURL>';
                var actionThuTucAllInOneURL = '<portlet:actionURL windowState="exclusive" name="actionThuTuc"></portlet:actionURL>';

                // ky so
                var getComputerHashURL = '<portlet:resourceURL id="getComputerHash"></portlet:resourceURL>';
                var getComputerHashDongDauURL = '<portlet:resourceURL id="getComputerHashDongDau"></portlet:resourceURL>';

                var hangHaiViewJX = new VueJX(
                    {
                        el: 'hangHaiViewJX',
                        pk: 1,
                        onScroll: 'onScroll',
                        data: {
                            menu: false,
                            data_state: JSON.parse(data_state),
                            data_doc_type: JSON.parse(data_doc_type),
                            showAfter: false,
                            valid: true,
                            ex11: true,
                            itemsGiayToXuatTrinhChoPhuongTien: [
                            ],
                            itemsGiayToXuatTrinh_39: [
                            ],
                            itemsGiayToXuatTrinh_40: [
                            ],
                            itemsGiayToXuatTrinh_48: [
                            ],
                            itemsGiayToXuatTrinh_49: [
                            ],
                            itemsGiayToXuatTrinh_50: [
                            ],
                            thoi_gian_dieu_dong: '',
                            ngay_cap: '',
                            ben_cang: '',
                            giay_phep_so: '',
                            cau_cang: '',
                            nguoi_ky: '',
                            muc_dic_neo_dau: '',
                            documentType: '0',
                            documentTypes: '',
                            
                            active_tab: null,
                            viewDefaultState: false,
                            loading_process_btn: false,
                            msgType: 0,
                            msg: '',
                            thong_bao_api: getPhanHoiTuCoQuanChuyenNganhTable,
                            ghi_chu_api: exportPDFDetail,
                            thanh_phan_ho_so_api: getThanhPhanHoSo,
                            file_list_api: getFileThanhPhanVersionList,
                            detail_tp_file_api: exportPDFDetailThanhPhan,
                            thong_tin_khai_bao_api: getThongTinKhaiBaoTable,
                            document_type_api: getDocTypes,
                            filter_adv_api: getFilterADVDataAPI,
                            shifting_api: getLenhDieuDongEXT,
                            port_clearance_api: getMessageType60EXT,
                            port_clearance_api_table: getMessageType60EXTTable,
                            port_clearance_api_table_qc: getMessageType60EXTTableQC,
                            port_clearance_api_90: getMessageType90EXT,
                            getComputerHashURL: getComputerHashURL,
                            getComputerHashDongDauURL: getComputerHashDongDauURL,
                            loadingroleUserFilter: false,
                            loadingHoSoTable: false,
                            screen_state: 0,
                            detail: {
                                id: 0,
                                portName: ''
                            },
                            detail_shifting: {

                            },
                            detailThanhPhan: {},
                            roleUserFilterselectedCode: 0,
                            roleUserFilterselectedType: 0,
                            kehoachActions: [],
                            ykienReject: '',
                            ykien: '',
                            maritimeName: '',
                            maritimeReferent: '',
                            canBoPheDuyet: '',
                            btn_role_status: -1,
                            userSigns: [],
                            itemRoleSelected: null,
                            thanhPhanLists: [],
                            sign: null,
                            signFieldName: '', 
                            filePath: '',
                            availablePheDuyet: 0,
                            activeTab: 0,
                            tinMois: [],
                            loadingTinMoi: true,
                            doc_type: 'NC'
                        },
                        schema: {
                            /** TODO menu filter */
                            'navigationFilter': {
                                'id': 'navigationFilter',
                                'name': 'navigationFilter',
                                'type': 'navigation',
                                'template': 'menu_template',
                                'template_content': 'hangHaiViewJX_form_template',
                                'events': {
                                    filterTinMoi: function (documentName) {
                                        var vm = this;

                                        var filterleft = vm.$refs.filterleft;
                                        filterleft.documentName = documentName

                                        filterleft.filterLeftSearch();
                                    },
                                    showTinMoi: function () {
                                        var vm = this;
                                        vm.loadingTinMoi= true;
                                        axios.get(getNotifications).then(function (response) {
                                            var serializable = response.data;
                                            vm.tinMois = serializable.data;
                                            vm.loadingTinMoi= false;
                                        }).catch(function (error) {
                                            console.log(error);
                                            vm.tinMois = [];
                                            vm.loadingTinMoi= false;
                                        });
                                    },
                                    changeTabs: function () {
                                        this.ykienReject = '';
                                        this.ykien = '';
                                    },
                                    backToForm: function () {
                                        var vm = this;
                                        vm.btn_role_status = 2;
                                        var hanghaidetailpdf = vm.$refs.hanghaidetailpdf;
                                        hanghaidetailpdf._clearFile();
                                        setTimeout(() => {
                                            var lenhDieuDong = vm.$refs.lenhDieuDong;
                                            console.log(lenhDieuDong);
                                            if (lenhDieuDong != null) {
                                                lenhDieuDong.process_lenh_dieu_dong();
                                            }

                                            var giayPhepRoiCang = vm.$refs.giayPhepRoiCang;
                                            console.log(giayPhepRoiCang);
                                            if (giayPhepRoiCang != null) {
                                                giayPhepRoiCang.process_giay_phep();
                                            }
                                            
                                            var giayPhepQuaCanh = vm.$refs.giayPhepQuaCanh;
                                            console.log(giayPhepQuaCanh);
                                            if (giayPhepQuaCanh != null) {
                                                giayPhepQuaCanh.process_giay_phep();
                                            }

                                        }, 500);
                                        
                                    },
                                    callActionKeHoachAllInOneURL: function (item, messageType, actionType, desStatus, isConfirm, returnState, isValidate) {
                                       var vm = this;
                                        if ((vm.$refs[vm.activeTab] != null && vm.$refs[vm.activeTab].validate()) || !isValidate) {
                                            if (isConfirm) {
                                                var x = confirm("Bạn có muốn thực hiện hành động này?");
                                                if (x) {
                                                    vm.loading_process_btn = true;
                                                    vm._actionKeHoachAllInOneURL(item, messageType, actionType, desStatus, returnState);
                                                    setTimeout(function(e){
                                                        var lenhDieuDong = vm.$refs.lenhDieuDong;
                                                        console.log(lenhDieuDong);
                                                        if (lenhDieuDong != null) {
                                                            lenhDieuDong.process_lenh_dieu_dong();
                                                        }

                                                        var giayPhepRoiCang = vm.$refs.giayPhepRoiCang;
                                                        console.log(giayPhepRoiCang);
                                                        if (giayPhepRoiCang != null) {
                                                            giayPhepRoiCang.process_giay_phep();
                                                        }
                                                        
                                                        var giayPhepQuaCanh = vm.$refs.giayPhepQuaCanh;
                                                        console.log(giayPhepQuaCanh);
                                                        if (giayPhepQuaCanh != null) {
                                                            giayPhepQuaCanh.process_giay_phep();
                                                        }
                                                    }, 1000);
                                                }
                                                else {
                                                    return false;
                                                }
                                            } else {
                                                vm.loading_process_btn = true;
                                                vm._actionKeHoachAllInOneURL(item, messageType, actionType, desStatus, returnState);
                                            }
                                        } else {
                                            alert('lý do bắt buộc phải nhập');
                                        }
                                    },
                                    _actionKeHoachAllInOneURL: function (item, messageType, actionType, desStatus, returnState) {
                                        var vm = this;
                                        var hanghaidetailpart = vm.$refs.hanghaidetailpart;
                                        var configParam = {
                                            
                                        };
                                        var params = new FormData();
                                        params.append('DOCUMENT_NAME', item.documentName);
                                        params.append('DOCUMENT_YEAR', item.documentYear);
                                        params.append('MESSAGE_TYPE', messageType);
                                        params.append('ACTION_TYPE', actionType);
                                        params.append('DOCUMENT_YEAR', item.documentYear);
                                        params.append('REQUEST_STATE', vm.detail.requestState);
                                        params.append('DOCUMENT_TYPE', vm.detail.documentTypeCode);
                                        params.append('DOCUMENT_STATUS_CODE', vm.detail.documentStatusCode);
                                        params.append('DES_STATUS', desStatus);
                                        params.append('REQUEST_CODE', vm.detailThanhPhan.requestCode);
                                        params.append('ykienReject', vm.ykienReject);
                                        params.append('sign', vm.sign);
                                        params.append('signFieldName', vm.signFieldName);
                                        params.append('filePath', vm.filePath);

                                        var lenhDieuDong = vm.$refs.lenhDieuDong;
                                        
                                        if (messageType === 70 && vm.roleUserFilterselectedType !== -4
                                            && vm.roleUserFilterselectedType !== -3 && lenhDieuDong != null) {
                                            console.log(lenhDieuDong);
                                            if (lenhDieuDong != null) {
                                                params.append('representative', lenhDieuDong.giamDoc.representative);
                                                params.append('shiftingDate', lenhDieuDong.shiftingDate);
                                                params.append('tugBoat', lenhDieuDong.detail_shifting.tugBoat);
                                                params.append('nameOfShip', lenhDieuDong.detail_shifting.nameOfShip);
                                                params.append('shownDraftxF', lenhDieuDong.detail_shifting.shownDraftxF);
                                                params.append('from', lenhDieuDong.detail_shifting.from);
                                                params.append('anchoringPortCode', JSON.stringify(lenhDieuDong.detail_shifting.anchoringPortCode));
                                                params.append('portHarbourCode', JSON.stringify(lenhDieuDong.detail_shifting.portHarbourCode));
                                                params.append('shiftingPortWharfCode', JSON.stringify(lenhDieuDong.detail_shifting.shiftingPortWharfCode));
                                                params.append('dwt', lenhDieuDong.detail_shifting.dwt);
                                                params.append('loa', lenhDieuDong.detail_shifting.loa);
                                                params.append('chanel', JSON.stringify(lenhDieuDong.chanel));
                                            }
                                        }

                                        axios.post(
                                            actionKeHoachAllInOneURL, 
                                            params,
                                            configParam
                                        ).then(function (response) {
                                            vm.loading_process_btn = false;
                                            var serializable = response.data;
                                            vm.msgType = 1;
                                            vm.msg = "Yêu cầu của bạn được thực hiện thành công!";
                                            
                                            vm.screen_state = returnState;
                                            if (returnState === 0) {
                                                vm._doFilterRoleData();
                                            } else {
                                                if (messageType > -1) {
                                                    vm._checkThanhPhanActionButton(messageType);
                                                }
                                                vm.callDetailHoSo();
                                                hanghaidetailpart.reloadThanhPhan();
                                            }
                                            setTimeout(function(e){
                                                vm.msgType = 0;
                                            }, 2000);

                                            // view pdf with custom pdf
                                            if (messageType === 70 && vm.roleUserFilterselectedType !== -4
                                                && vm.roleUserFilterselectedType !== -3 && lenhDieuDong != null) {
                                                console.log(lenhDieuDong);
                                                if (lenhDieuDong != null) {
                                                    vm._changefileListVersion(vm.detailThanhPhan);
                                                }
                                            }
                                        }).catch(function (error) {
                                            console.log(error);
                                            vm.loading_process_btn = false;
                                            vm.msgType = 2;
                                            vm.msg = "Yêu cầu của bạn được thực hiện thất bại!";
                                            setTimeout(function(e){
                                                vm.msgType = 0;
                                            }, 2000);
                                        });
                                    },
                                    callActionThuTucAllInOneURL: function (item, messageType, actionType, desStatus, isConfirm, returnState, isValidate) {
                                       var vm = this;
                                       if ((vm.$refs[vm.activeTab] != null && vm.$refs[vm.activeTab].validate()) || !isValidate) {
                                            if (isConfirm) {
                                                var x = confirm("Bạn có muốn thực hiện hành động này?");
                                                if (x) {
                                                    vm.loading_process_btn = true;
                                                    vm._actionThuTucAllInOneURL(item, messageType, actionType, desStatus, returnState);
                                                }
                                                else {
                                                    return false;
                                                }
                                            } else {
                                                vm.loading_process_btn = true;
                                                vm._actionThuTucAllInOneURL(item, messageType, actionType, desStatus, returnState);
                                            }
                                        } else {
                                            alert('lý do bắt buộc phải nhập');
                                        }
                                    },
                                    _actionThuTucAllInOneURL: function (item, messageType, actionType, desStatus, returnState) {
                                        var vm = this;
                                        var hanghaidetailpart = vm.$refs.hanghaidetailpart;
                                        var hanghaidetailxacnhan = vm.$refs.hanghaidetailxacnhan;
                                        var configParam = {
                                            
                                        };
                                        var params = new FormData();
                                        params.append('DOCUMENT_NAME', item.documentName);
                                        params.append('DOCUMENT_YEAR', item.documentYear);
                                        params.append('MESSAGE_TYPE', messageType);
                                        params.append('ACTION_TYPE', actionType);
                                        params.append('DOCUMENT_YEAR', item.documentYear);
                                        params.append('REQUEST_STATE', vm.detail.requestState);
                                        params.append('DOCUMENT_TYPE', vm.detail.documentTypeCode);
                                        params.append('DOCUMENT_STATUS_CODE', vm.detail.documentStatusCode);
                                        params.append('DES_STATUS', desStatus);
                                        params.append('REQUEST_CODE', vm.detailThanhPhan.requestCode);
                                        params.append('ykienReject', vm.ykienReject);
                                        params.append('sign', vm.sign);
                                        params.append('signFieldName', vm.signFieldName);
                                        params.append('filePath', vm.filePath);

                                        var giayPhepRoiCang = vm.$refs.giayPhepRoiCang;
                                        var giayPhepQuaCanh = vm.$refs.giayPhepQuaCanh;

                                        if (messageType === 60 && vm.roleUserFilterselectedType !== -4
                                            && vm.roleUserFilterselectedType !== -3 && giayPhepRoiCang != null) {
                                            console.log(giayPhepRoiCang);
                                            if (giayPhepRoiCang != null) {
                                                params.append('representative', giayPhepRoiCang.giamDoc.representative);
                                                params.append('detail_clearance', JSON.stringify(giayPhepRoiCang.detail_clearance));
                                                params.append('detail_clearance_data', JSON.stringify(giayPhepRoiCang.khaiBaoItems));
                                                params.append('timeOfDeparture', giayPhepRoiCang.timeOfDeparture);
                                                params.append('timeOfValidUntil', giayPhepRoiCang.timeOfValidUntil);
                                                params.append('issueDate', giayPhepRoiCang.issueDate);
                                            }
                                        }

                                        if (messageType === 90 && vm.roleUserFilterselectedType !== -4
                                            && vm.roleUserFilterselectedType !== -3 && giayPhepQuaCanh != null) {
                                            console.log(giayPhepQuaCanh);
                                            if (giayPhepQuaCanh != null) {
                                                params.append('representative', giayPhepQuaCanh.giamDoc.representative);
                                                params.append('detail_clearance', JSON.stringify(giayPhepQuaCanh.detail_clearance));
                                                params.append('detail_clearance_data', JSON.stringify(giayPhepQuaCanh.khaiBaoItems));
                                                params.append('timeOfDeparture', giayPhepQuaCanh.timeOfDeparture);
                                                params.append('timeOfValidUntil', giayPhepQuaCanh.timeOfValidUntil);
                                                params.append('issueDate', giayPhepQuaCanh.issueDate);
                                            }
                                        }

                                        if (messageType === 2014) {
                                            params.append('itemsGiayToXuatTrinhChoPhuongTien', JSON.stringify(vm.itemsGiayToXuatTrinhChoPhuongTien));
                                            params.append('itemsGiayToXuatTrinh_39', JSON.stringify(vm.itemsGiayToXuatTrinh_39));
                                            params.append('itemsGiayToXuatTrinh_40', JSON.stringify(vm.itemsGiayToXuatTrinh_40));
                                        }

                                        if (messageType === 23) {
                                            params.append('soChungNhan', hanghaidetailxacnhan.soChungNhan);
                                            params.append('ngayPheDuyet', hanghaidetailxacnhan.ngayPheDuyet);
                                            params.append('lePhi', hanghaidetailxacnhan.lePhi);
                                        }

                                        if (hanghaidetailxacnhan != null && messageType == 1985) {
                                            params.append('soChungNhan', hanghaidetailxacnhan.soChungNhan);
                                            params.append('ngayPheDuyet', hanghaidetailxacnhan.ngayPheDuyet);
                                            params.append('lePhi', hanghaidetailxacnhan.lePhi);
                                        }

                                        axios.post(
                                            actionThuTucAllInOneURL, 
                                            params,
                                            configParam
                                        ).then(function (response) {
                                            vm.loading_process_btn = false;
                                            var serializable = response.data;
                                            vm.msgType = 1;
                                            vm.msg = "Yêu cầu của bạn được thực hiện thành công!";
                                            
                                            vm.screen_state = returnState;
                                            if (returnState === 0) {
                                                vm._doFilterRoleData();
                                            } else {
                                                if (messageType > -1) {
                                                    vm._checkThanhPhanActionButton(messageType);
                                                }
                                                vm.callDetailHoSo();
                                                hanghaidetailpart.reloadThanhPhan();
                                            }
                                            setTimeout(function(e){
                                                vm.msgType = 0;
                                            }, 2000);

                                            // view pdf with custom pdf
                                            if (messageType === 60 && vm.roleUserFilterselectedType !== -4
                                                && vm.roleUserFilterselectedType !== -3 && giayPhepRoiCang != null) {
                                                console.log(giayPhepRoiCang);
                                                if (giayPhepRoiCang != null) {
                                                    vm._changefileListVersion(vm.detailThanhPhan);
                                                }
                                            }

                                            if (messageType === 90 && vm.roleUserFilterselectedType !== -4
                                                && vm.roleUserFilterselectedType !== -3 && giayPhepQuaCanh != null) {
                                                console.log(giayPhepQuaCanh);
                                                if (giayPhepQuaCanh != null) {
                                                    vm._changefileListVersion(vm.detailThanhPhan);
                                                }
                                            }
                                            
                                        }).catch(function (error) {
                                            console.log(error);
                                            vm.loading_process_btn = false;
                                            vm.msgType = 2;
                                            vm.msg = "Yêu cầu của bạn được thực hiện thất bại!";
                                            setTimeout(function(e){
                                                vm.msgType = 0;
                                            }, 2000);
                                        });
                                    },
                                    kysoSubmit: function(config) {
                                        console.log(config);
                                        this.sign = config.sign;
                                        this.signFieldName = config.signFieldName;
                                        this.filePath = config.filePath;
                                        if (config.messageType == 70) {
                                            this.callActionKeHoachAllInOneURL(config.item, config.messageType, config.actionType, config.desStatus, config.isConfirm, config.returnState, false);
                                        } else {
                                            this.callActionThuTucAllInOneURL(config.item, config.messageType, config.actionType, config.desStatus, config.isConfirm, config.returnState, false);
                                        }
                                    },
                                    pickHoSo: function (item, index) {
                                        var vm = this;
                                        var filterleft = vm.$refs.filterleft;
                                        var filteradv = vm.$refs.filteradv;
                                        vm.documentType = item.code;
                                        filterleft.documentType = item;
                                        vm.roleUserFilterselected === -1;
                                        
                                        filteradv.status_label = "Kế hoạch";
                                        vm._initroleUserFilter(vm.documentType);

                                    },
                                    getDocumentTypes: function (config) {
                                        var vm = this;
                                        var filterleft = vm.$refs.filterleft;
                                        var filteradv = vm.$refs.filteradv;
                                        vm.documentType = filterleft.documentType.code;

                                        if (config != null && config.doFilter === 1) {

                                        } else {
                                            vm._initroleUserFilter(vm.documentType);
                                        }

                                        axios.get(counterHoSoAll, {
                                            params: {
                                                'shipName': filterleft.shipName,
                                                'documentName': filterleft.documentName,
                                                'callSign': filterleft.callSign
                                            }
                                        }).then(function (response) {
                                            var serializable = response.data;
                                            for (var key in serializable) {
                                                var idCounter = "tt_count_" + serializable[key]["code"];
                                                var idCounterEl = document.getElementById(idCounter);
                                                if (idCounterEl != null) {
                                                    idCounterEl.innerHTML = serializable[key]["total"];
                                                }
                                            }
                                        }).catch(function (error) {
                                            console.log(error);
                                        });
                                        vm.documentTypes = filterleft.documentTypes;
                                        vm.loadingroleUserFilter = true;
                                        vm.roleUserFilterselected === -1;
                                        filteradv.status_label = "Kế hoạch";
                                        //vm._doFilterRoleData();
                                        /*
                                        var vm = this;
                                        var filterleft = vm.$refs.filterleft;
                                        var filteradv = vm.$refs.filteradv;
                                        vm.documentType = item.code;
                                        filterleft.documentType = item;
                                        vm.roleUserFilterselected === -1;
                                        
                                        filteradv.status_label = "Kế hoạch";
                                        vm._initroleUserFilter(vm.documentType);
                                        */
                                    },
                                    thanhPhanSelected: function (config) {
                                        var vm = this;
                                        vm.detailThanhPhan = config.item;
                                        vm.detailThanhPhan['shipName'] = vm.detail['shipName'];
                                        vm.detailThanhPhan['documentName'] = vm.detail['documentName'];
                                        vm.detailThanhPhan['callSign'] = vm.detail['callSign'];
                                        vm.detailThanhPhan['messageType'] = config.item.messageType;
                                        vm.detailThanhPhan['documentYear'] = vm.detail['documentYear'];
                                        vm.detailThanhPhan['documentType'] = vm.detail['documentTypeCode'];
                                        vm.screen_state = 2;
                                        vm.viewDefaultState = false;
                                        window.history.pushState('', '', themeDisplay.getLayoutURL() + '/-/document/' + vm.detail['id'] + '/' + config.item.messageType);

                                        var hanghaidetailpart = vm.$refs.hanghaidetailpart;
                                        vm.thanhPhanLists = hanghaidetailpart.thanhPhanLists;
                                        vm.availablePheDuyet = 0;

                                        if (vm.detailThanhPhan['code'] === 'lenh_dieu_dong') {
                                            vm.btn_role_status = 2;
                                            setTimeout(() => {
                                                var lenhDieuDong = vm.$refs.lenhDieuDong;
                                                console.log(lenhDieuDong);
                                                if (lenhDieuDong != null) {
                                                    lenhDieuDong.process_lenh_dieu_dong();
                                                }
                                            }, 500);
                                        } else if (vm.detailThanhPhan['messageType'] === 2014) {
                                            vm._getGiayToXuatTrinhPhuongTien();
                                            vm._getGiayToXuatTrinh_39();
                                            vm._getGiayToXuatTrinh_40();
                                            vm._getGiayToXuatTrinh_48();
                                            vm._getGiayToXuatTrinh_49();
                                            vm._getGiayToXuatTrinh_50();
                                        } else if (vm.detailThanhPhan['messageType'] === 23) {
                                            vm._getMessageType23EXT();
                                        } else if (vm.detailThanhPhan['messageType'] === 60) {
                                            setTimeout(() => {
                                                var giayPhepRoiCang = vm.$refs.giayPhepRoiCang;
                                                console.log(giayPhepRoiCang);
                                                if (giayPhepRoiCang != null) {
                                                    giayPhepRoiCang.process_giay_phep();
                                                }
                                            }, 500);
                                        } else if (vm.detailThanhPhan['messageType'] === 90) {
                                            setTimeout(() => {
                                                var giayPhepQuaCanh = vm.$refs.giayPhepQuaCanh;
                                                console.log(giayPhepQuaCanh);
                                                if (giayPhepQuaCanh != null) {
                                                    giayPhepQuaCanh.process_giay_phep();
                                                }
                                            }, 500);
                                        }
                                        setTimeout(() => {
                                            vm._changefileListVersion(vm.detailThanhPhan);
                                            vm._checkThanhPhanActionButton(config.item.messageType);
                                            var hanghaidetailxacnhan = vm.$refs.hanghaidetailxacnhan;

                                            if (hanghaidetailxacnhan != null) {
                                                hanghaidetailxacnhan.reloadData();
                                                var alblo = hanghaidetailxacnhan.availableKeQuaPheDuyetF();
                                                console.log(alblo);
                                                vm.availablePheDuyet = alblo;
                                            }
                                            
                                        }, 200);
                                    },
                                    _getMessageType23EXT: function () {
                                        var vm = this;
                                        axios.get(getMessageType23EXT, {
                                            params: {
                                                'documentName': vm.detailThanhPhan.documentName,
                                                'documentYear': vm.detailThanhPhan.documentYear,
                                                'documentType': vm.detailThanhPhan.documentType
                                            }
                                        }).then(function (response) {
                                            var serializable = response.data;
                                            vm.detail['soChungNhan'] = serializable.soChungNhan;
                                            vm.detail['ngayPheDuyet'] = serializable.ngayPheDuyet;
                                            vm.detail['lePhi'] = serializable.lePhi;
                                        }).catch(function (error) {
                                            console.log(error);
                                        });
                                    },
                                    _checkThanhPhanActionButton: function (messageType) {
                                        var vm = this;
                                        axios.get(checkThanhPhanActionButton, {
                                            params: {
                                                'documentName': vm.detailThanhPhan.documentName,
                                                'documentYear': vm.detailThanhPhan.documentYear,
                                                'messageType': vm.detailThanhPhan.messageType,
                                                'roleType': vm.roleUserFilterselectedType,
                                                'REQUEST_CODE': vm.detailThanhPhan.requestCode,
                                                'documentType': vm.detailThanhPhan.documentType
                                            }
                                        }).then(function (response) {
                                            var serializable = response.data;
                                            vm.btn_role_status = serializable.data;
                                            vm.userSigns = serializable.userSigns;
                                        }).catch(function (error) {
                                            console.log(error);
                                        });
                                    },
                                    _changefileListVersion: function (item) {
                                        var vm = this;
                                        var pdfViewChild = vm.$refs.hanghaidetailpdf;
                                        pdfViewChild.file_lists = [];
                                        axios.get(getFileThanhPhanVersionList, {
                                            params: {
                                                'documentName': item.documentName,
                                                'documentYear': item.documentYear,
                                                'messageType': item.messageType,
                                                'documentType': item.documentType
                                            }
                                        }).then(function (response) {
                                            var serializable = response.data;
                                            if (serializable != null && serializable.length > 0) {
                                                pdfViewChild.nodata = false;
                                                pdfViewChild._showFile(serializable);
                                            } else {
                                                console.log("error get file thanh phan list");
                                                pdfViewChild.nodata = true;
                                                pdfViewChild.loadingPDF = false;
                                            }
                                        }).catch(function (error) {
                                            console.log(error);
                                        });
                                    },
                                    _getGiayToXuatTrinhPhuongTien: function () {
                                        var vm = this;
                                        axios.get(getGiayToXuatTrinhPhuongTien, {
                                            params: {
                                                'documentName': vm.detailThanhPhan.documentName,
                                                'documentYear': vm.detailThanhPhan.documentYear,
                                                'documentTypeCode': vm.detail.documentTypeCode,
                                            }
                                        }).then(function (response) {
                                            var serializable = response.data;
                                            vm.itemsGiayToXuatTrinhChoPhuongTien = serializable;
                                        }).catch(function (error) {
                                            console.log(error);
                                        });
                                    },
                                    _getGiayToXuatTrinh_39: function () {
                                        var vm = this;
                                        axios.get(getGiayToXuatTrinh_39, {
                                            params: {
                                                'documentName': vm.detailThanhPhan.documentName,
                                                'documentYear': vm.detailThanhPhan.documentYear,
                                                'documentTypeCode': vm.detail.documentTypeCode,
                                            }
                                        }).then(function (response) {
                                            var serializable = response.data;
                                            vm.itemsGiayToXuatTrinh_39 = serializable;
                                        }).catch(function (error) {
                                            console.log(error);
                                        });
                                    },
                                    _getGiayToXuatTrinh_40: function () {
                                        var vm = this;
                                        axios.get(getGiayToXuatTrinh_40, {
                                            params: {
                                                'documentName': vm.detailThanhPhan.documentName,
                                                'documentYear': vm.detailThanhPhan.documentYear,
                                                'documentTypeCode': vm.detail.documentTypeCode,
                                            }
                                        }).then(function (response) {
                                            var serializable = response.data;
                                            vm.itemsGiayToXuatTrinh_40 = serializable;
                                        }).catch(function (error) {
                                            console.log(error);
                                        });
                                    },
                                    _getGiayToXuatTrinh_48: function () {
                                        var vm = this;
                                        axios.get(getGiayToXuatTrinh_48, {
                                            params: {
                                                'documentName': vm.detailThanhPhan.documentName,
                                                'documentYear': vm.detailThanhPhan.documentYear,
                                                'documentTypeCode': vm.detail.documentTypeCode,
                                            }
                                        }).then(function (response) {
                                            var serializable = response.data;
                                            vm.itemsGiayToXuatTrinh_48 = serializable;
                                        }).catch(function (error) {
                                            console.log(error);
                                        });
                                    },
                                    _getGiayToXuatTrinh_49: function () {
                                        var vm = this;
                                        axios.get(getGiayToXuatTrinh_49, {
                                            params: {
                                                'documentName': vm.detailThanhPhan.documentName,
                                                'documentYear': vm.detailThanhPhan.documentYear,
                                                'documentTypeCode': vm.detail.documentTypeCode,
                                            }
                                        }).then(function (response) {
                                            var serializable = response.data;
                                            vm.itemsGiayToXuatTrinh_49 = serializable;
                                        }).catch(function (error) {
                                            console.log(error);
                                        });
                                    },
                                    _getGiayToXuatTrinh_50: function () {
                                        var vm = this;
                                        axios.get(getGiayToXuatTrinh_50, {
                                            params: {
                                                'documentName': vm.detailThanhPhan.documentName,
                                                'documentYear': vm.detailThanhPhan.documentYear,
                                                'documentTypeCode': vm.detail.documentTypeCode,
                                            }
                                        }).then(function (response) {
                                            var serializable = response.data;
                                            vm.itemsGiayToXuatTrinh_50 = serializable;
                                        }).catch(function (error) {
                                            console.log(error);
                                        });
                                    },
                                }
                            },
                            'roleUserFilter': {
                                'id': 'roleUserFilter',
                                'name': 'roleUserFilter',
                                'type': 'listgroup',
                                'show_counter': true,
                                'counter': 'counter',
                                'child_items': 'items',
                                'data_title': 'title',
                                'data_value': 'id',
                                'onLoad': '_initroleUserFilter',
                                'onClick': 'filterChange',
                                'events': {
                                    onScroll: function () {
                                    
                                    },
                                    _doFilterRoleData: function () {
                                        var vm = this;
                                        vm.khoDuLieuHoSoList = 1;
                                        var filterleft = vm.$refs.filterleft;
                                        var configParam = {};
                                        if (vm.roleUserFilterselected === -2 || vm.roleUserFilterselectedType === -2) {
                                            configParam = {
                                                params: {
                                                    'documentTypeCode': filterleft.documentType.code,
                                                    'documentStatusCode': vm.roleUserFilterselectedCode,
                                                    'shipName': filterleft.shipName,
                                                    'maBanKhai': filterleft.documentName,
                                                    'callSign': filterleft.callSign,
                                                }
                                            };
                                            vm.loadingHoSoTable = false;
                                            vm._initHoSoThuTuc(configParam);
                                        } else if (vm.roleUserFilterselected === -1 || vm.roleUserFilterselectedType === -1) {
                                            configParam = {
                                                params: {
                                                    'documentTypeCode': filterleft.documentType.code,
                                                    'requestState': vm.roleUserFilterselectedCode,
                                                    'shipName': filterleft.shipName,
                                                    'maBanKhai': filterleft.documentName,
                                                    'callSign': filterleft.callSign,
                                                }
                                            };
                                            vm.loadingHoSoTable = false;
                                            vm._initHoSoKeHoach(configParam);
                                        } else if (vm.roleUserFilterselected === 0 || vm.roleUserFilterselectedType === 0) {
                                            vm.loadingHoSoTable = false;
                                            axios.get(getHistoryTable, {
                                                params: {
                                                    'documentTypeCode': "document_history"
                                                }
                                            }).then(function (response) {
                                                var serializable = response.data;
                                                vm.khoDuLieuHoSoListItems = serializable.data;
                                                vm.khoDuLieuHoSoListTotal = Math.ceil(serializable.total / 15);
                                                vm.khoDuLieuHoSoListTotalCount = serializable.total;
                                                vm.maritimeName = serializable.maritimeName;
                                                vm.maritimeReferent = serializable.maritimeReferent;    
                                                vm.canBoPheDuyet = serializable.canBoPheDuyet;
                                                vm.loadingHoSoTable = true;
                                            }).catch(function (error) {
                                                console.log(error);
                                            });
                                        } else if (vm.roleUserFilterselectedType === -3 || vm.roleUserFilterselectedType === -4) {
                                            vm._khoDuLieuHoSoListTable();
                                        }
                                        
                                        if (vm.itemRoleSelected != null) {
                                            vm.filterChangeCount(vm.itemRoleSelected);
                                        } else {
                                            vm.filterChangeCount(vm.roleUserFilterItems[0]);
                                        }
                                    },
                                    fillCounterToMenu: function (rootIndex, childIndex, counter) {
                                        var filteredArray = this.roleUserFilterItems.filter(function(item){
                                            return item.index === rootIndex;
                                        });
                                        filteredArray[0].items[childIndex].counter = counter;
                                    },
                                    filterChangeCount: function (item) {
                                        var vm = this;
                                        var filterleft = vm.$refs.filterleft;
                                        if (vm.roleUserFilterselectedType === -1) {
                                            var childIndex = 0;
                                            for (var key in item.items) {
                                                axios.get(counterHoSoKeHoachTable, {
                                                    params: {
                                                        'documentTypeCode': filterleft.documentType.code,
                                                        'requestState': item.items[key].code,
                                                        'rootIndex': 0,
                                                        'childIndex': childIndex,
                                                        'shipName': filterleft.shipName,
                                                        'documentName': filterleft.documentName,
                                                        'callSign': filterleft.callSign
                                                    }
                                                }).then(function (response) {
                                                    var serializable = response.data;
                                                    vm.fillCounterToMenu(serializable.rootIndex, serializable.childIndex, serializable.total);
                                                }).catch(function (error) {
                                                    console.log(error);
                                                });
                                                childIndex = childIndex + 1;
                                            }
                                        } else if (vm.roleUserFilterselectedType === -2) {
                                            var childIndex = 0;
                                            for (var key in item.items) {
                                                axios.get(counterHoSoThuTucTable, {
                                                    params: {
                                                        'documentTypeCode': filterleft.documentType.code,
                                                        'documentStatusCode': item.items[key].code,
                                                        'rootIndex': 1,
                                                        'childIndex': childIndex,
                                                        'shipName': filterleft.shipName,
                                                        'documentName': filterleft.documentName,
                                                        'callSign': filterleft.callSign
                                                    }
                                                }).then(function (response) {
                                                    var serializable = response.data;
                                                    vm.fillCounterToMenu(serializable.rootIndex, serializable.childIndex, serializable.total);
                                                })
                                                .catch(function (error) {
                                                    console.log(error);
                                                });
                                                childIndex = childIndex + 1;
                                            }
                                        }
                                    },
                                    filterChange: function (item) {
                                        var vm = this;
                                        if (item.id === -1 || item.id === -2) {
                                            vm.itemRoleSelected = item;
                                        }
                                        vm.khoDuLieuHoSoListTotalCount = 0;
                                        var filterleft = vm.$refs.filterleft;
                                        var filteradv = vm.$refs.filteradv;
                                        vm.roleUserFilterselected = item.id;
                                        vm.roleUserFilterselectedType = item.type;
                                        vm.roleUserFilterselectedCode = item.code;
                                        vm.khoDuLieuHoSoListpage = 1;
                                        filteradv.status_label = item.title;
                                        if (vm.roleUserFilterselected === -1) {
                                            var childIndex = 0;
                                            for (var key in item.items) {
                                                axios.get(counterHoSoKeHoachTable, {
                                                    params: {
                                                        'documentTypeCode': filterleft.documentType.code,
                                                        'requestState': item.items[key].code,
                                                        'rootIndex': 0,
                                                        'childIndex': childIndex
                                                    }
                                                }).then(function (response) {
                                                    var serializable = response.data;
                                                    vm.fillCounterToMenu(serializable.rootIndex, serializable.childIndex, serializable.total);
                                                }).catch(function (error) {
                                                    console.log(error);
                                                });
                                                childIndex = childIndex + 1;
                                            }
                                        } else if (vm.roleUserFilterselected === -2) {
                                            var childIndex = 0;
                                            for (var key in item.items) {
                                                axios.get(counterHoSoThuTucTable, {
                                                    params: {
                                                        'documentTypeCode': filterleft.documentType.code,
                                                        'documentStatusCode': item.items[key].code,
                                                        'rootIndex': 1,
                                                        'childIndex': childIndex
                                                    }
                                                }).then(function (response) {
                                                    var serializable = response.data;
                                                    vm.fillCounterToMenu(serializable.rootIndex, serializable.childIndex, serializable.total);
                                                })
                                                .catch(function (error) {
                                                    console.log(error);
                                                });
                                                childIndex = childIndex + 1;
                                            }
                                        }
                                        
                                        vm._doFilterRoleData();
                                    },
                                    _initroleUserFilter: function (data) {
                                        var vm = this;
                                        var configRole = {
                                            params: {
                                                'documentType': vm.documentType
                                            }
                                        }
                                        axios.get(
                                            getRoleFilterStatus, 
                                            configRole
                                        ).then(function (response) {
                                            var serializable = response.data;
                                            vm.loadingroleUserFilter = true;
                                            vm.roleUserFilterItems = serializable;
                                            if (serializable.length > 0) {
                                                vm.roleUserFilterselected = serializable[0]['id'];
                                                vm.roleUserFilterselectedType = serializable[0]['type'];
                                                vm.roleUserFilterselectedCode = serializable[0]['code'];
                                            }
                                            vm.roleUserFilterItemSelect = serializable[0];
                                            vm._doFilterRoleData();
                                        }).catch(function (error) {
                                            console.log(error);
                                            vm.roleUserFilterItems = [];
                                        });
                                    }
                                }
                            },
                            'khoDuLieuHoSoList': {
                                'id': 'khoDuLieuHoSoList',
                                'name': 'khoDuLieuHoSoList',
                                'type': 'table',
                                'cssClass': 'table-bordered danhSachHoSoTable__class table_border_right_none',
                                'item_key': 'id',
                                'headers': 'headers',
                                'no_data_text': 'Không có dữ liệu!',
                                'template': 'activity_expand_list_template',
                                'pagging': '_khoDuLieuHoSoListTable',
                                'paggingcustom': '_khoDuLieuHoSoPaggingCustom',
                                'onLoad': '_initHeaders',
                                'events': {
                                    _khoDuLieuHoSoPaggingCustom: function (page) {
                                        var vm = this;
                                        console.log(page);
                                        vm.khoDuLieuHoSoListpage = page.page;
                                        vm._khoDuLieuHoSoListTable();
                                    },
                                    filteraction: function () {
                                        this._khoDuLieuHoSoListTable();
                                        console.log(this.documentType);
                                        if (this.documentType == 0 || this.documentType == '') {
                                            console.log('do 1');
                                            this.getDocumentTypes({doFilter: 1});
                                        } else {
                                            console.log('do 2');
                                            this._doFilterRoleData();
                                        }
                                    },
                                    _khoDuLieuHoSoListTable: function () {
                                        var vm = this;
                                        var configParam = {};
                                        var filterleft = vm.$refs.filterleft;
                                        if (vm.roleUserFilterselected === -2 || vm.roleUserFilterselectedType === -2) {
                                            configParam = {
                                                params: {
                                                    'documentTypeCode': filterleft.documentType.code,
                                                    'documentStatusCode': vm.roleUserFilterselectedCode,
                                                    'shipName': filterleft.shipName,
                                                    'maBanKhai': filterleft.documentName,
                                                    'callSign': filterleft.callSign,
                                                    'start': vm.khoDuLieuHoSoListpage*15 - 15,
                                                    'end': vm.khoDuLieuHoSoListpage*15
                                                }
                                            };
                                            vm.loadingHoSoTable = false;
                                            vm._initHoSoThuTuc(configParam);
                                        } else if (vm.roleUserFilterselected === -1 || vm.roleUserFilterselectedType === -1) {
                                            configParam = {
                                                params: {
                                                    'documentTypeCode': filterleft.documentType.code,
                                                    'requestState': vm.roleUserFilterselectedCode,
                                                    'shipName': filterleft.shipName,
                                                    'maBanKhai': filterleft.documentName,
                                                    'callSign': filterleft.callSign,
                                                    'start': vm.khoDuLieuHoSoListpage*15 - 15,
                                                    'end': vm.khoDuLieuHoSoListpage*15
                                                }
                                            };
                                            vm.loadingHoSoTable = false;
                                            vm._initHoSoKeHoach(configParam);
                                        } else if (vm.roleUserFilterselectedType === -3) {
                                            configParam = {
                                                params: {
                                                    'documentTypeCode': 'document_sign',
                                                    'requestState': vm.roleUserFilterselectedCode,
                                                    'shipName': filterleft.shipName,
                                                    'maBanKhai': filterleft.documentName,
                                                    'callSign': filterleft.callSign,
                                                    'start': vm.khoDuLieuHoSoListpage*15 - 15,
                                                    'end': vm.khoDuLieuHoSoListpage*15
                                                }
                                            };
                                            vm.loadingHoSoTable = false;
					                        vm._initHistoryTable(configParam);
                                        } else if (vm.roleUserFilterselectedType === -4) {
                                            configParam = {
                                                params: {
                                                    'documentTypeCode': 'document_approve',
                                                    'requestState': vm.roleUserFilterselectedCode,
                                                    'shipName': filterleft.shipName,
                                                    'maBanKhai': filterleft.documentName,
                                                    'callSign': filterleft.callSign,
                                                    'start': vm.khoDuLieuHoSoListpage*15 - 15,
                                                    'end': vm.khoDuLieuHoSoListpage*15
                                                }
                                            };
                                            vm.loadingHoSoTable = false;
					                        vm._initHistoryTable(configParam);
                                        } else {
                                            configParam = {
                                                params: {
                                                    'documentTypeCode': 'document_history',
                                                    'requestState': vm.roleUserFilterselectedCode,
                                                    'shipName': filterleft.shipName,
                                                    'maBanKhai': filterleft.documentName,
                                                    'callSign': filterleft.callSign,
                                                    'start': vm.khoDuLieuHoSoListpage*15 - 15,
                                                    'end': vm.khoDuLieuHoSoListpage*15
                                                }
                                            };
                                            vm.loadingHoSoTable = false;
					                        vm._initHistoryTable(configParam);
                                        }
                                    },
                                    _initHistoryTable: function(configParam) {
                                        var vm = this;
                                        axios.get(getHistoryTable, configParam).then(function (response) {
                                            var serializable = response.data;
                                            vm.khoDuLieuHoSoListItems = serializable.data;
                                            vm.khoDuLieuHoSoListTotal = Math.ceil(serializable.total / 15);
                                            vm.khoDuLieuHoSoListTotalCount = serializable.total;
                                            vm.loadingHoSoTable = true;
                                        })
                                        .catch(function (error) {
                                            console.log(error);
                                            vm.khoDuLieuHoSoListItems = [];
                                            vm.loadingHoSoTable = true;
                                        });
                                    },
                                    _initHoSoKeHoach: function (configParam) {
                                        var vm = this;
                                        vm.khoDuLieuHoSoListTotalCount = 0;
                                        axios.get(
                                            getHoSoKeHoachTable, 
                                            configParam
                                        ).then(function (response) {
                                            var serializable = response.data;
                                            vm.khoDuLieuHoSoListItems = serializable.data;
                                            vm.khoDuLieuHoSoListTotalCount = serializable.total;
                                            vm.khoDuLieuHoSoListTotal = Math.ceil(serializable.total / 15);
                                            vm.maritimeName = serializable.maritimeName;
                                            vm.maritimeReferent = serializable.maritimeReferent;
                                            vm.canBoPheDuyet = serializable.canBoPheDuyet;
                                            vm.loadingHoSoTable = true;
                                        }).catch(function (error) {
                                            console.log(error);
                                            vm.khoDuLieuHoSoListItems = [];
                                            vm.loadingHoSoTable = true;
                                        });
                                    },
                                    _initHoSoThuTuc: function (configParam) {
                                        var vm = this;
                                        vm.khoDuLieuHoSoListTotalCount = 0;
                                        axios.get(
                                            getHoSoThuTucTable, 
                                            configParam
                                        ).then(function (response) {
                                            var serializable = response.data;
                                            vm.khoDuLieuHoSoListItems = serializable.data;
                                            vm.khoDuLieuHoSoListTotalCount = serializable.total;
                                            vm.khoDuLieuHoSoListTotal = Math.ceil(serializable.total / 15);
                                            vm.maritimeName = serializable.maritimeName;
                                            vm.maritimeReferent = serializable.maritimeReferent;
                                            vm.canBoPheDuyet = serializable.canBoPheDuyet;
                                            vm.loadingHoSoTable = true;
                                        }).catch(function (error) {
                                            console.log(error);
                                            vm.khoDuLieuHoSoListItems = [];
                                            vm.loadingHoSoTable = true;
                                        });
                                    },
                                    _initHeaders: function () {
                                        this.khoDuLieuHoSoListheaders = JSON.parse(data_header);
                                    },
                                    toDetailHoSo: function (state, item) {
                                        var vm = this;
                                        vm.screen_state = state;
                                        vm.detail = item;
                                        vm.detail['maritimeName'] = vm.maritimeName;
                                        vm.detail['maritimeReferent'] = vm.maritimeReferent;
                                        vm.detail['canBoPheDuyet'] = vm.canBoPheDuyet;
                                        vm.doc_type = vm.data_doc_type[vm.detail.documentTypeCode];
                                        window.history.pushState('', '', themeDisplay.getLayoutURL() + '/-/document/' + item.id);	
                                    },
                                    callDetailHoSo: function () {
                                        var vm = this;
                                        var hanghaidetail = vm.$refs.hanghaidetail;
                                        axios.get(getDetailHoSo, {
                                            params: {
                                                'documentName':  vm.detail.documentName,
                                                'documentYear':  vm.detail.documentYear
                                            }
                                        }).then(function (response) {
                                            var serializable = response.data;
                                            vm.detail = serializable;
                                            vm.detail['maritimeName'] = vm.maritimeName;
                                            vm.detail['maritimeReferent'] = vm.maritimeReferent;
                                            vm.detail['canBoPheDuyet'] = vm.canBoPheDuyet;
                                        }).catch(function (error) {
                                            console.log(error);
                                        });
                                        if (hanghaidetail != null) {
                                            hanghaidetail.reloadKhaiBao();
                                        }
                                    },
                                    backState: function (state) {
                                        var vm = this;
                                        vm.screen_state = state;
                                        if (state === 0) {
                                            window.history.pushState('', '', themeDisplay.getLayoutURL());
                                        } else if (state === 1) {
                                            window.history.pushState('', '', themeDisplay.getLayoutURL() + '/-/document/' + vm.detail['id']);	
                                        }
                                    }
                                }
                            }
                        }
                    });

                hangHaiViewJX._builder('hangHaiViewJX');

            });
</script>

<style>
    .lenh_dieu_dong_form .input-group {
        padding: 0;
        padding-left: 0;
    }

    .lenh_dieu_dong_form .subheader {
        height: auto;
        min-height: 32px
    }

    .lenh_dieu_dong_form .lodo-pl0 {
        padding-left: 0 !important;
    }
    
    body .giay_to_xuat_trinh table.table th:nth-child(1) {
        width: 32px;
        padding: 0;
    }
    body .giay_to_xuat_trinh table.table th:nth-child(2) {
        width: 300px;
    }
    body .giay_to_xuat_trinh table.table th:nth-child(3) {
        width: 120px;
    }
    body .giay_to_xuat_trinh table.table th:nth-child(4) {
        width: 120px;
    }
    body .giay_to_xuat_trinh table.table th:nth-child(5) {
        width: 120px;
    }
    body .giay_to_xuat_trinh table.table th:nth-child(7) {
        width: 20px;
    }
    body .giay_to_xuat_trinh table.table th:nth-child(8) {
        width: 20px;
    }
    body .table-bordered tbody > tr > td{
        border-right: 1px solid lightgray;
    }
    body .datatable .tooltip .icon {
        font-size: 14px;
        cursor: pointer;
    }
    body .menuable__content__active {
        margin-left: 1%;
    }
</style>